{% extends 'base.html' %}
{% block title %}Home - eGadget Rent{% endblock %}
{% block content %}
<div class="hero hero--xl with-photo position-relative overflow-hidden p-4 p-md-5 mb-4" style="--hero: url('https://img.freepik.com/premium-photo/flat-lay-blue-desk-with-laptop-headphones_977617-43963.jpg')">
  <div class="text-center position-relative" style="z-index:2;">
    <h1 class="fw-bold mb-2 hero-title" id="heroTitle">Welcome to Your Gadget Hub</h1>
    <p class="mb-3 hero-subtitle" id="heroSubtitle">Rent laptops, cameras, headphones and more — fast and easy.</p>
    <a href="#catalog" class="btn btn-primary btn-lg btn-cta">Explore Gadgets</a>
  </div>
  <!-- Auto-rotating overlay banners -->
  <div class="hero-rotator" id="heroRotator"
       data-banners='[
         "https://img.freepik.com/premium-photo/flat-lay-blue-desk-with-laptop-headphones_977617-43963.jpg",
         "https://images.unsplash.com/photo-1498050108023-c5249f4df085?w=1600",
         "https://images.unsplash.com/photo-1518770660439-4636190af475?w=1600",
         "https://images.unsplash.com/photo-1519389950473-47ba0277781c?w=1600"
       ]'
       data-text='[
         {"title":"Welcome to Your Gadget Hub","subtitle":"Rent laptops, cameras, headphones and more — fast and easy."},
         {"title":"Weekend Rentals, Big Savings","subtitle":"Grab 10% off on weekend bookings today."},
         {"title":"Students Get Extra 5% Off","subtitle":"Show valid ID to unlock exclusive discounts."},
         {"title":"First Rental? Save 20%","subtitle":"Enjoy a generous first-time customer offer."}
       ]'>
  </div>
  <!-- No floating/collage when using photo banner -->
</div>

<!-- Category Image Showcase -->
<div class="category-showcase" id="categoryShowcase" aria-label="Category showcase">
  <div class="container-fluid">
    <div class="category-showcase-grid" id="categoryShowcaseGrid">
      <!-- Images will be populated by JavaScript -->
    </div>
    <div class="subcategory-panel mt-3" id="subcategoryPanel" aria-label="Subcategories panel">
      <!-- Subcategories will appear here after clicking a main category -->
    </div>
  </div>
</div>

<!-- PROMOTIONAL CARDS BANNER (SECOND BANNER) -->
<div class="row g-3 mb-4 promotional-cards">
  <!-- Card 1: 10% OFF -->
  <div class="col-md-4">
    <div class="promo-card promo-card-1 p-4 rounded text-white h-100 d-flex flex-column justify-content-between" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); box-shadow: 0 8px 24px rgba(102, 126, 234, 0.2);">
      <div>
        <h5 class="fw-bold mb-2">10% OFF</h5>
        <p class="small mb-0 opacity-90">On all weekend rentals</p>
      </div>
      <div class="mt-3">
        <span class="badge bg-white text-dark fw-semibold">Weekend Special</span>
      </div>
    </div>
  </div>

  <!-- Card 2: Student Discount -->
  <div class="col-md-4">
    <div class="promo-card promo-card-2 p-4 rounded text-white h-100 d-flex flex-column justify-content-between" style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); box-shadow: 0 8px 24px rgba(17, 153, 142, 0.2);">
      <div>
        <h5 class="fw-bold mb-2">Student Discount</h5>
        <p class="small mb-0 opacity-90">Extra 5% off with valid ID</p>
      </div>
      <div class="mt-3">
        <span class="badge bg-white text-dark fw-semibold">Students Only</span>
      </div>
    </div>
  </div>

  <!-- Card 3: First Order -->
  <div class="col-md-4">
    <div class="promo-card promo-card-3 p-4 rounded text-white h-100 d-flex flex-column justify-content-between" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); box-shadow: 0 8px 24px rgba(245, 87, 108, 0.2);">
      <div>
        <h5 class="fw-bold mb-2">First Order</h5>
        <p class="small mb-0 opacity-90">20% off on your first rental</p>
      </div>
      <div class="mt-3">
        <span class="badge bg-white text-dark fw-semibold">New Customers</span>
      </div>
    </div>
  </div>
</div>

<div id="catalog" class="row g-3">
  {% for p in products %}
  <div class="col-6 col-md-3">
    <a href="{{ url_for('product_detail', product_id=p.id) }}" class="card h-100 card-hover text-decoration-none text-reset product-link">
      <img src="{{ p.image_url or url_for('static', filename='images/placeholder.png') }}" class="card-img-top object-fit-contain p-3 img-hover" style="height:180px;" alt="{{ (p.brand_name or p.brand or '') }} {{ p.model_name or p.name }}">
      <div class="card-body d-flex flex-column">
        <h6 class="card-title mb-1">{{ (p.brand_name or p.brand or '') }} {{ p.model_name or p.name }}</h6>
        <div class="small text-muted">{{ p.brand_name or p.brand or '' }} • {{ p.category }}{% if p.subcategory or p.sub %} • {{ p.subcategory or p.sub }}{% endif %}{% if p.condition %} • {{ p.condition }}{% endif %}</div>
        <div class="mt-1">
          {% if p.available %}
            <span class="badge bg-success">Available</span>
          {% else %}
            <span class="badge bg-secondary">Unavailable</span>
          {% endif %}
        </div>
        {% if p.get('avg_rating') %}
          <div class="mb-2">
            <span class="text-warning small">
              {% for i in range(1,6) %}
                {% if i <= p.avg_rating|int %}<i class="bi bi-star-fill"></i>{% else %}<i class="bi bi-star"></i>{% endif %}
              {% endfor %}
            </span>
            <span class="text-muted small ms-1">({{ p.reviews_count }})</span>
          </div>
        {% endif %}
        <div class="mt-auto d-flex justify-content-between align-items-center">
          <span class="fw-bold">₹ {{ '%.2f'|format(p.rent_per_day or 0) }}/day</span>
          <span class="btn btn-sm btn-outline-primary btn-hover">View</span>
        </div>
      </div>
    </a>
  </div>
  {% endfor %}
  {% if not products %}
    <div class="col-12 text-center text-muted py-5">No items found</div>
  {% endif %}
</div>
{% endblock %}
